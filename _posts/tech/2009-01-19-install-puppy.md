---
layout: post
title: Puppy Linuxのインストールについて
category: tech
tags: [linux,puppy,install]
---

このブログ中では「そんなん考えなくてもわかるでしょ？」で端折った、インストール作業…

もう、3回入れ直しているけど、実は独自ノウハウの塊なような気がしてきたので、
ちゃんと書こうと思います。

# やったこと

## BIOSにHDD(もしくはIDEに接続されている何か)を認識させる

旧機なら結構ここにハマる。CD立ち上げしてから、「え、HDD無いの？」みたいになります。

BIOS上で文字情報としてHDDが認識されていることを確認。無い場合は自分で定義します。

(旧機に対して、新しいHDDの場合、少ない容量しか入力できない場合があるが、多少嘘ついてもOS起動後は関係ないので、ようは"在る"と思い込ませること。)

## CDブート出来ないマシンなのでフロッピーでCDブート出来るように始動

SmartBootManagerをフロッピーに焼く。やりかたは[このブログの他記事](/tech/2009/01/18/floppy-boot)参照。

フロッピー入れたまま電源ON。

## PuppyLinuxをCDで立ち上げ

SmartBootManagerの画面から、CD-BOOTを選択しEnter。

一度目は絶対エラーと言われるが、もう一回やるとCDから読み込み始まる。

## fdiskでパーティションを切る

Puppyが立ち上がってきたことを前提として、fdiskでHDDのパーティションを切ります。

多分、旧機ならUIがとんでもなく遅いと思うので、デスクトップから”端末”を立ち上げ、fdiskを実行。

あと、旧機ならswap領域を多めに切るようにしましょう。

## mkfs.ext3,mkswap

fdiskで切ったパーティションを初期化。

し終わったら、swaponを絶対にしておくこと。

旧機ならかなりの命綱だと思われ(俺だけ？)、その後の作業がだいぶ楽になった。

## ハードディスクにインストール

メニュー → セットアップ → Puppyユニバーサルインストーラを選択。

画面が上がってきたら、右上端の「パピーを〜にインストール」ボタンを押下。

ダイアログが何個かあがるが、だいたい”OK"で。

「２通りの方法があります」は、「FULL」を選ぶ。

「コピーしています」とか、ダイアログが立ち上がっては消えを繰り返しますが、「ああ終わったか。よし。」とか思っても、GRUB設定のダイアログが上がってくるまでは絶対電源を切らないでください。

「赤子ないても蓋取るな」精神です。

起動方法のダイアログは「GRUBインストール/更新」ボタン押下、
次のダイアログは、「インストール」ボタンを押下。

「GRUB CONFIG」は「simple」選択。

「フレームバッファコンソール用に設定」は「standard」選択。

「GRUBパーティションの選択」は、デフォルトでHDDが表示されているので、「OK」を押下。

「GRUBを置く場所の選択」は、「MBR」を選択。

再度GRUBを設定するか聞いてくるので、「No」を押下する。

これで、多分終わってるはずなのだが、本当に終わっているかを見る。(やり直すのは長いので)

topコマンドに、install系コマンドが上がってきてないならOK(と、言うことにしておこう)

そして、メニューから再起動を選ぶ。コンソールに降り、SAVEするか聞いてくる。

ここで「SAVE TO FILE」を選択すると、すべての作業が水の泡になるので、「DO NOT SAVE」を選ぶ。

## ネットワーク設定

再起動後、HDDから立ち上がることにほっとする。

メニュー → セットアップ → ネットワークウィザードを選択、

「やぁ、ネットワークの設定は簡単じゃないけど、頑張っていこう！」画面(なんちゅうw)から、eth0ボタンを押下。

「eth0 ネットワークを設定」は、「固定IP」ボタンを押下。

「固定IPをセット」画面で、自分のネットワーク設定を行う。

「デフォルトルートは 〜 を通してセットしました。」「eth0 ネ ットワークの設定に成功!」が出れば、完了。Yesボタンを押下。

## hostname変更

`/etc/hostname`,`/etc/hostsP` を、自分の好きなのに変更。

## /bin/busybox をroot以外も使えるように。

サーバ運用&ssh接続が前提なので、一般ユーザからsuとか叩けるようにしなくてはならないが、このディストリの組み込みコマンドはbusyboxで出来ているので、コマンドが実行できません。

(そもそも、rootオンリー運用前提で、一般ユーザで叩かれることを想定していない)

```bash
chmod 4755 /bin/busybox
```

これがしていいことかダメなことか、わからんけど...

## rootパスワード変更、一般ユーザ追加

あとは「通例」なり「お好み」で。

---

ここからは、ブログ一回目からの設定どおりです。
書き出すと、長いものだなあ。
