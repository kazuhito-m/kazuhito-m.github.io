---
layout: post
title: 勉強会行ってみた「DDD（ドメイン駆動設計）実践者の話を聞いてみよう」#Devkan
category: study-meeting-repo
tags: [ddd]
---

![会場の様子](/images/2015-09-19-ddd2.jpg)

重要なのは解る…が、勉強が追いついてない、足り無い！

## 情報

+ [申し込みサイト](https://devlove-kansai.doorkeeper.jp/events/30012)
+ ハッシュタグ : [#devkan](https://twitter.com/hashtag/devkan)
+ 何するのか : 著名人や実践者から「DDDの"実際"」を聞く…のかな。

## なんで来たん？

去年くらいから、DDDの勉強を始めたんです。

全然手探りだったのですが、先日の「[関西DDD.java](http://kansaiddd.connpass.com/event/17737/)」の増田さんの言葉で
「俺、間違って無かったんや…」「俺、これかもしれん…」という確信めいた何かをもらった…気がしておりまして。

最近「関西でDDDと名が付けば」勉強会に参加して行ってる次第で…今回もやって来ました！(その増田さんの来阪ですしね)

## 内容

### 1コマ目「ドメイン駆動設計 思えば遠くにきたもんだ」

+ 登壇者: 増田 亨さん ( [@masuda220](https://github.com/masuda220) )
+ 資料: <iframe src="//www.slideshare.net/slideshow/embed_code/key/BevtPE8jbuRTyY" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/masuda220/ss-52960414" title="ドメイン駆動設計 思えば遠くにきたもんだ" target="_blank">ドメイン駆動設計 思えば遠くにきたもんだ</a> </strong> from <strong><a href="//www.slideshare.net/masuda220" target="_blank">増田 亨</a></strong> </div>

「エリックエバンスのドメイン駆動設計」の書籍を題材に、増田さんの歩んだ道ともに、DDDの勘所をお教えいただいています。

資料は素晴らしくまとめられていますが、「お話」に真骨頂だったと思うので、
箇条書きおいておきます。(少し意訳)

### 「お話」成分補完メモ

+ ドメインモデル
  + 「要は…？」の話しへの切り込み、コアつかみに行く
  + コアがぼやけると、ドメインそのものもボケる
  + 設計やモデルは日々成長するものだ
      + 機能までが今日正しいとは限らない
      + 「完成したものがある…ソレを探し当てる」…では無いのだ
      + 「モデルがキレイ」「コードがキレイ」が「出来た」ではないという懐疑心
+ 「モデル」と「実装」を結びつける
  + 脳内イメージと実装が一致してない…これは違う
+ ソフトウエアの核心にある複雑さ
  + 挑戦し続けている
+ 「適応型」のソフトウェア開発
  + 「新しいことしようぜ」みたいなヒューマニティを維持する
+ 転換点
  + ずっと疑問だったこと
    + アジャイルでの「設計」のやり方
      + XPは最初「だめだこりゃ」と思った
+ 変化を目指すチーム
  + シンプリシティ
      + 「単純」は「要素を絞る」と勘違いしてしまうとダメ
      + 粗結合の追求
      + 「重要な感心事」と「ソレ以外の区別」をしておくこと
  + フィードバック
      + 議論より行動を
  + 勇気
      + 「おかしさを耐え忍ぶ」という忍耐力
  + リスペクト
      + 「お互いのか投げと行動に関心を持つ」のが刺さった
+ 変化に適応しながら成長を続ける
  + ソフトウエアの核心にある複雑さに立ち向かうための開発スタイル
      + チームが成長して良い方向へいく
      + 画面やデータより「コアはなにか？」を追い求めるアプローチを模索中
      + 最初に「コアモデルを作る」というやり方
+ オブジェクト思考と「変更容易性」
  + モジュラープログラミング
      + Erlangなどが「最初にオブジェクト志向が目指した世界」なんじゃないか
+ オブジェクト志向への道
  + オブジェクト指向言語はよくわかって無かった
      + 冗長で遅いものだとしか思わなかった
      + 1998年ごろ、ベターCでしかなかった
+ 転換点 : 大規模(炎上)案件への誘い
  + C#だからというわけではないｗ
  + リファクタリング
      + 面白いように効果が出てくる
+ 手続き型からオブジェクト志向へ
  + 型をつけていくことにより「どこになにがあるか」を把握しやすく成る

### 心に残った事

+ 本質的"でない"モノを削る力

これはわかるのですが…難しいのですよね。人間は「増やす」方のベクトルのほうが強いですし。

でも、これができていると「見た人の理解が早い」
転じて「立場違いの人がレビュー出来そうなモデル」になるかなと…最近の感じです。

+ 抽象データ型・段階的な抽象化、コードを人間に近づけていく

すごくしっくりくる、いつも考えてるのはこういうことなんですよね。

### 質問タイム

+ Q : 炎上案件は12/31に相談の電話だそうですが、いつから参加？
+ A : 正月明けから 土日は休めと言った

なんとも、ヒューマニティを尊重する増田さんらしいブレない回答でしたｗ

---

増田さんのお話を聞くのは2回目なのですが「あまりにも自然に共感・納得してしまう」ので…
「もしかして…曲解して解ったつもりになってないか？」と自問せねばならず、大変ですｗ


### ２コマ目「T字形ER手法の話」(題名失念)

+ 登壇者 : 尾篭 盛さん( [@ogomr](https://twitter.com/ogomr) )
+ 資料 : [Qiitaの記事](http://qiita.com/ogomr/items/8616ace9f32efc0eecd7)

「ぷ…PlantUMLや…！！」

Graphbiz系から自力でたどりついて、現場でつかってた「[PlantUML](http://yohshiy.blog.fc2.com/blog-entry-152.html)」の話しが出てきたので、それに興奮してしまって…
本編の記憶が飛んでます。(すみません)

話し的には「T字形ER手法(TM)」の話しだったと思うのですが…

「データベース設計の話がDDDのモデリングに？」と、頭の悪い俺にはようわかりませんでした。

## ３コマ目「ドメイン『駆動』『開発』」

+ 登壇者 : 前川 博志さん( [@posaune](https://twitter.com/posaune) )
+ 資料 : <iframe src="//www.slideshare.net/slideshow/embed_code/key/9PIP6SmhYt4Ys" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/Posaune/ss-52982034" title="ドメイン『駆動』『開発』" target="_blank">ドメイン『駆動』『開発』</a> </strong> from <strong><a href="http://www.slideshare.net/Posaune" target="_blank">Hiroshi Maekawa</a></strong> </div>

+ DDDを広めるための取り組み

「生きた今のDDDだなー」と感心しました。

結局「超越者orエスパー/ウィザード級」が四次元ポケットから出てこない世界…なのであれば、
これを経るしか「DDDを(実践であんじょうよう)やる」ってのは無いのかなぁと。

そう、俺もこういう環境を整えて入門すべしかなーと。

+ ドメインに駆動される話

「あれ？基本そうじゃないっけ？」って思いました。

多分指してるものが違うのでしょうけれど…

一年生の頃(15年以上前)から「うわっ…想定外の何かが出てきた！」「こいつは重用事！」
って時には「クラス図」を囲んで「あーだこーだ」と先輩らが騒ぎ始める…。

ERでも画面図でもなく「お客業務の縮図」を見て「どうしょっか？」するのが日常
…な世界で育ったので。

重用事なら「ドメイン(その頃はビジネス層って言うてましたが)から変更」され、
ドメイン実装が変更される。

画面や周辺実装(ちょっとズレるもののDDDのアプリケーション層かな?)だけで片付けられようものなら
「そもそも重用事じゃない」…みたいな。

ま、そんな「しょーもない浅っさい俺の話」とは違うと思いますよ！思いますよ！

---

全然関係無いけど…告知されてた「[第28回 TFSUG大阪 継続的デリバリーを実現するTeam Foundation Server / Visual Studio Online特集](https://tfsug.doorkeeper.jp/events/31243)」、
めっさ気になる！ので、参加したいなーと。

## ４コマ目「保守とDDDと私」
　
+ 登壇者 : 川辺 卓矢さん( [@kawakawa](https://twitter.com/kawakawa) )
+ 資料 : <iframe src="//www.slideshare.net/slideshow/embed_code/key/jUFc2mKFuzhayy" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;" allowfullscreen> </iframe> <div style="margin-bottom:5px"> <strong> <a href="//www.slideshare.net/kawakawa__/ddd-52952272" title="保守とDddと私" target="_blank">保守とDddと私</a> </strong> from <strong><a href="//www.slideshare.net/kawakawa__" target="_blank">Takuya Kawabe</a></strong> </div>

なんとなく…立ち場は違えど「なんとなく解かる」事が多かったり…。

+ 「チェックボックスから、ラジオボタンに変えるだけでも…」話

こんな細かい話しをしたいわけでは無いと思いますが…
チェック→ラジオに変えるってことは「On/Offの問題」から「"択"という量を扱うもの」に変化するわけです。

(似たような話しとしては「メッセージボックスのボタン択」も)

それって「意味が変わってる」ので「ドメインに影響を与えないわけはない」と思うのですが…
どうも世では「小手先で片付けるには…」で「なんでそこ(ドメイン)修正しあかんの？」と聞き入れられないことが多いすね。

こういうとこを妥協しない姿勢も、DDDマインド何じゃないかと共感しました。

+ 「DDDから見れば、永遠の開発期間であって欲しいのですが、現実問題そうも言ってられません(涙」

そうなんすよ…そうなんす。

アジャイルの話もそうなんすけど「良くしたい…のに！終わりが(別軸で)決まる」という構造は、
もう「政治・契約」の領域の話しなので…どうにもならない「DDDをさせない」バイアスなのかな、とも。

## ダイアログ

受付時、付箋とペンを配られ「自身が疑問・問題に思うもの」を各自書いて前のHBに貼る…とした結果、

0. DDDをどう実装するの
0. DDDとモデリング
0. DDDをどうチーム・組織に入れていくのか

の3テーマにおしなべ、それを元に「4〜6人の3チーム、2交代」制で話し合いました。

俺は「ずっと実装のとこ」に居たのですが…

+ インフラストラクチャとドメインの境界
+ 実現するのに最適な道具選択

に、話が寄っていた気がします。

俺自身には「(絶対に曲解して間違っているであろう)思い込みがある」ので迷わないのですが、
「ここに皆さん興味を割いているのかー」と思いました。

## 増田さんに聞いてみようディスカッション

唐突に前川さん司会、増田さんを壇に置いてのディスカッションが始まりました。

これ、めっちゃおもろかったのでメモを置いときます。※正確性はちょい自信無いです

### Q&A内容メモ

+ Q.UMLとか使いますか？
+ A.開発者の脳とコードにしかないですね

チームが「劇的に全入れ替えとかしない」という前提
リモートワークやってる利点として「共有時に記録される」ので履歴が追える

+ Q.変化点の微妙なものは?
+ A.劇的に変わっているだろう

+ Q.変更するときはお客さんに確認取るの？
+ A.基本は必要ないが、必要ならばの類

+ Q.DDDをどうチーム・組織に入れてくか
+ A.社長を抑えに行け

これは冗談めいた言い方でしたが、
増田さんいわく「チームが利害関係者(ステークホルダ)を押さえに行く」という力が居るでしょうね、
とのこと。

別解としては「経営者のほうが夢を語れる」し、
そこと話し出来るには「技術者も社員じゃ夢を語れない」と言うことから
「はよ独立しなさい」というメッセージをもらいました。

+ Q.実装で関数型言語での実現はどうですか？
+ A.問わない、ダーティでも「多く使われてる言語」で「汚くしない」努力をすべし

Haskelの考え方は良いと思う。

「実現にダーティにしがちで問題になるところ」を
言語仕様として「部品(メイビーモナドなど)」入れているのは、
今後の動きに期待と興味がある。

私は土俵は「オブジェクト志向」で、
そこに「存在を脅かすほどの多きな問題」を抱えていると思っていないため、
Javaでよい。

### まさかの逆質問

増田さんが問い、会場の参加者が答える、という一幕も。

+ Q.Scalaとかで実装している人が居る？グルーピングとかは?
+ A.変わらない、パッケージ、ファイル、クラス、オブジェクト…

増田さんの興味の質として…

_再利用性の高いものとして扱う時に「言語仕様としてサポートしている」か
無いなら「どういうふうにやってくか」_

というとこが関心事で、今も試行錯誤であるとのこと。

ご自身もコーチとしてのチーム育成をされているようで、

0. Javaの２つのチームやScalaのチームをレビューしていくと、最終的に「よく似たコード」になる
0. チームは気付きとしての成長が在る

が面白いとのこと。

_「再利用可能にするデザイニング」は、言語仕様により補助や難威はあれど、
本質は一緒でかつチームの習熟と比例する_

ということなのですかね。※ちょっと間違ってるかも

### 最近のDDD熱について

+ Q. バズワードになっているようですが、どう捉えていますか
+ A.「設計を良くしたい」と思う人々の興味で「設計手法」としての集約点は、今「DDD」くらいしか無いからでは？

増田さんは、もう少しつっこんで話されて

+ 「設計」にトレンドが無い「喪失の時代」を経ての今日、な気がしている
+ 「オブジェクト志向」の次のトレンドとしての「関数型」が、別に「設計」をくれているわけじゃないから
+ ようやく「変更容易性など」の「プログラムで作りたい対象」のことを考えれる時代が来たのでは？

とした上で、

_「OOの信望者」だけが賛辞を送っているのを考えると「そんなに多きなトレンドじゃないんじゃね？」と思ってる_

と、意外なお答えがありました。

そこからの逆質問で

Q.みんな、なぜ「DDD」というコンテキストで勉強会来てるの？

と参加者に問われ、

0. 大規模かつダーティなプロジェクトに抗うため
0. OOでのよりよいソフトウェアづくりがしたくて
0. 「若い頃の投資回収」と「精神衛生上の救い」を求めて(俺)

と、参加者のいくつかの答えがありました。

お一人目の時に出た言葉、

_「腐敗防止層どうのこうのじゃない、全部腐っているんだ！」_

は名言だと思いました。

---

「汎用パッケージより難しい問題」のアプリケーションを作らねばならない…のに！「管理」や「納期」と
戦い疲弊している…という現状で

_ソフトウェア作成は難しいもんなんだよ(だからDDDを欲してるのではないかな)_

という増田さんの言葉でしめていました。

## 小並感

色々感想を用意していましたが…
「まずお前はDDD本を読め」が全てです。
ありがとうございました。

## おまけ

遅刻して座った席の横に「(これ系の勉強会では)珍しくお若い女性」の姿がありました。

俺は、辛抱たまらん(いやそういう意味でなくて、あくまでも知的好奇心がってことでね)ようになったので、
2つの質問をしました。

0. ここにはどうやってたどり着きましたか？
0. 何を持って帰るために来てますか？

俺は「女性と3分話すと、相手が死んだ魚の目になる」という思い病気や呪いのようなもの、を患っているのですが…

その方は超親切に

0. 「設計手法」の勉強会をネットで検索して
0. 自身の日々の開発が「どうしたら良くなるか」から「設計手法」を学びたくて

という答えをいただきました。(ありがとうございました)

+ そういう方も一定数居てるねんな
+ 宣伝に力入れれば来ていただけるんだな

という感想を持ち「もしかして未来に希望を持てる？」と思いました。

…スタッフした時には宣伝に力入れよっとｗ
